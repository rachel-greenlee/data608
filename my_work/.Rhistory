knitr::opts_chunk$set(message=FALSE, warning=FALSE, out.width = "100%")
library('dplyr')
library('ggplot2')
library('kableExtra')
library('formattable')
mpeach <- "#FBAA82"
mteal <- "#73A2AC"
mdarkteal <- "#OB5D69"
mgray <- "#4C4C4C"
# set plot theme for assignment
my_plot_theme <- list(
theme_classic() +
theme(plot.background = element_rect(fill = "#F3F2E8"),
panel.background = element_rect(fill = "#F3F2E8"),
panel.grid.major.x = element_line(color = "white"),
axis.title.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold")))
inc <- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA_608/master/module1/Data/inc5000_data.csv", header= TRUE)
kable((head(inc, 10)), format = 'markdown')
summary(inc)
kable((head(inc, 10)), format = 'markdown')
kable((tail(inc, 10)), format = 'markdown')
kable(inc %>%
count(State, sort = TRUE),
format = 'markdown')
kable(inc %>%
count(Industry, sort = TRUE),
format = 'markdown')
# create 2-variable df of States & counts
state_freq <- inc %>% count(State, sort = TRUE)
# sort df by count so graph displays ordered and not alphabetically
state_freq$State <- factor(state_freq$State,
levels = state_freq$State[order(state_freq$n, decreasing = FALSE)])
# plot generation
ggplot(data = state_freq, aes(x = n, y = State)) +
geom_col(fill=mpeach) +
labs(title = "California, Texas, and New York have the Most Companies",
subtitle = "with California having 181% (314) more companies than second-place Texas",
x="# of Companies in the Ranking",
y="State") +
scale_x_continuous(limits = c(0, 800),
expand = c(.01, 0.5),
breaks = seq(0, 800, 100)) +
geom_text(
aes(x = n, label = n),
size = 3,
color = mgray, hjust = 0) +
my_plot_theme
# filter for just NY data
# filter for complete cases (they all were w/o NAs)
# plot to show median across industries in NY
inc %>%
filter(State == "NY", complete.cases(.)) %>%
ggplot(aes(x = reorder(Industry, Employees, median), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal, outlier.size = 2) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="Industry",
y="# of Employees per Company in NY") +
ylim(NA, 1000) +
my_plot_theme
# show counts sorted high to low of companies within each industry in NY
kable(inc %>%
filter(State == "NY") %>%
count(Industry, sort = TRUE),
format = 'markdown')
inc %>%
filter(complete.cases(.)) %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot) %>%
ggplot(aes(x = reorder(Industry, rev_per_emp), y = rev_per_emp)) +
geom_bar(stat = "identity", fill = mpeach) +
coord_flip() +
labs(title = "Revenue per Employee by Industry",
subtitle = "total revenue of industry / total count employees of industry",
x = "Industry",
y = "Revenue per Employee") +
scale_y_continuous(limits = c(0, 1350000),
labels = scales::label_dollar()) +
geom_text(aes(label = currency(rev_per_emp, digits = 0L)),
size=3,
color = mgray,
hjust = -0.1) +
my_plot_theme
library(tinytex)
install.packages("tinytex")
updates.packages(ask = FALSE< checkBuilt = TRUE)
update.packages(ask = FALSE, checkBuilt = TRUE)
tinytex::tlmgr_update()
library(tinytex)
library(tinytex)
tinytex::tlmgr_update()
library('dplyr')
library('ggplot2')
library('kableExtra')
library('formattable')
library('TinyTeX')
library('dplyr')
library('ggplot2')
library('kableExtra')
library('formattable')
library('tinytex')
mpeach <- "#FBAA82"
mteal <- "#73A2AC"
mdarkteal <- "#OB5D69"
mgray <- "#4C4C4C"
# set plot theme for assignment
my_plot_theme <- list(
theme_classic() +
theme(plot.background = element_rect(fill = "#F3F2E8"),
panel.background = element_rect(fill = "#F3F2E8"),
panel.grid.major.x = element_line(color = "white"),
axis.title.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold")))
fmtutil --all
remove.packages("tinytex", lib="~/R/win-library/4.0")
install.packages('tinytex')
library('tinytex')
tinytex::install_tinytex()
