ylim(NA, 1000) +
my_plot_theme
library('dplyr')
library('ggplot2')
mpeach <- "#FBAA82"
mteal <- "#73A2AC"
mdarkteal <- "#OB5D69"
# plot generation
ggplot(data = state_freq, aes(x = n, y = State)) +
geom_col(fill="#FBAA82") +
labs(title = "California, Texas, and New York have the Most Companies",
subtitle = "with California having 181% (314) more companies than second-place Texas",
x="# of Companies in the Ranking",
y="State") +
scale_x_continuous(limits = c(0, 800),
expand = c(.01, 0.5),
breaks = seq(0, 800, 100)) +
geom_text(
aes(x = n, label = n),
size = 3,
color = mpeach, hjust = 0) +
my_plot_theme
mgray <- "#4C4C4C"
# plot generation
ggplot(data = state_freq, aes(x = n, y = State)) +
geom_col(fill=mpeach) +
labs(title = "California, Texas, and New York have the Most Companies",
subtitle = "with California having 181% (314) more companies than second-place Texas",
x="# of Companies in the Ranking",
y="State") +
scale_x_continuous(limits = c(0, 800),
expand = c(.01, 0.5),
breaks = seq(0, 800, 100)) +
geom_text(
aes(x = n, label = n),
size = 3,
color = mgray, hjust = 0) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(fill = mpeach) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(fill = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(fill = mteal, outlier.color = mpeach) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(stat = "identity", fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, middle, Employees), y = Employees)) +
geom_boxplot(stat = "identity", fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, median, Employees), y = Employees)) +
geom_boxplot(stat = "identity", fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, middle), y = Employees)) +
geom_boxplot(stat = "identity", fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(stat = "identity", fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Employees, y = reoder(Employees, Industry)) +
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = reoder(Employees, Industry)) +
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = reoder(Employees, Industry) +
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = reoder(Employees, Industry)) +
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = reoder(Employees, Industry))) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# filter for just NY data
inc_ny <- inc %>%
library('dplyr')
library('ggplot2')
mpeach <- "#FBAA82"
mteal <- "#73A2AC"
mdarkteal <- "#OB5D69"
mgray <- "#4C4C4C"
inc <- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA_608/master/module1/Data/inc5000_data.csv", header= TRUE)
head(inc)
summary(inc)
head(inc, 10)
tail(inc, 10)
inc %>% count(State, sort = TRUE)
inc %>% count(Industry, sort = TRUE)
# create 2-variable df of States & counts
state_freq <- inc %>% count(State, sort = TRUE)
# sort df by count so graph displays ordered and not alphabetically
state_freq$State <- factor(state_freq$State,
levels = state_freq$State[order(state_freq$n, decreasing = FALSE)])
# set plot theme for assignment
my_plot_theme <- list(
theme_classic() +
theme(plot.background = element_rect(fill = "#EFE7DB"),
panel.background = element_rect(fill = "#EFE7DB"),
panel.grid.major.x = element_line(color = "white"),
axis.title.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold")))
# plot generation
ggplot(data = state_freq, aes(x = n, y = State)) +
geom_col(fill=mpeach) +
labs(title = "California, Texas, and New York have the Most Companies",
subtitle = "with California having 181% (314) more companies than second-place Texas",
x="# of Companies in the Ranking",
y="State") +
scale_x_continuous(limits = c(0, 800),
expand = c(.01, 0.5),
breaks = seq(0, 800, 100)) +
geom_text(
aes(x = n, label = n),
size = 3,
color = mgray, hjust = 0) +
my_plot_theme
# filter for just NY data
inc_ny <- inc %>%
filter(State == "NY")
# filter for complete cases (they all were w/o NAs)
inc_ny <- inc_ny[complete.cases(inc_ny),]
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = reoder(Employees, Industry))) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = reorder(Employees, Industry))) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = reorder(Employees, Industry))) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = Employees) +
# filter for just NY data
inc_ny <- inc %>%
filter(State == "NY")
# filter for complete cases (they all were w/o NAs)
inc_ny <- inc_ny[complete.cases(inc_ny),]
# filter for just NY data
inc_ny <- inc %>%
filter(State == "NY")
# filter for complete cases (they all were w/o NAs)
inc_ny <- inc_ny[complete.cases(inc_ny),]
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = Employees) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# filter for just NY data
inc_ny <- inc %>%
filter(State == "NY")
# filter for complete cases (they all were w/o NAs)
inc_ny <- inc_ny[complete.cases(inc_ny),]
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = Industry, y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# filter for just NY data
inc_ny <- inc %>%
filter(State == "NY")
# filter for complete cases (they all were w/o NAs)
inc_ny <- inc_ny[complete.cases(inc_ny),]
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# filter for just NY data
inc_ny <- inc %>%
filter(State == "NY")
# filter for complete cases (they all were w/o NAs)
inc_ny <- inc_ny[complete.cases(inc_ny),]
# plot to show median across industries in NY
ggplot(inc_ny, aes(x = reorder(Industry, Employees, median), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# create 2-variable df of industry & counts
ny_ind_freq <- inc_ny %>%
count(Industry, sort = TRUE)
ny_ind_freq
# create 2-variable df of industry & counts
inc_ny %>%
count(Industry, sort = TRUE)
# create 2-variable df of industry & counts
inc_ny %>%
count(Industry, sort = TRUE)
inc %>%
filter(State == "NY", complete.cases(.)) %>%
ggplot(inc_ny, aes(x = reorder(Industry, Employees, median), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
inc %>%
filter(State == "NY", complete.cases(.)) %>%
ggplot(aes(x = reorder(Industry, Employees, median), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
library('dplyr')
library('ggplot2')
mpeach <- "#FBAA82"
mteal <- "#73A2AC"
mdarkteal <- "#OB5D69"
mgray <- "#4C4C4C"
inc <- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA_608/master/module1/Data/inc5000_data.csv", header= TRUE)
head(inc)
summary(inc)
head(inc, 10)
tail(inc, 10)
inc %>% count(State, sort = TRUE)
inc %>% count(Industry, sort = TRUE)
# create 2-variable df of States & counts
state_freq <- inc %>% count(State, sort = TRUE)
# sort df by count so graph displays ordered and not alphabetically
state_freq$State <- factor(state_freq$State,
levels = state_freq$State[order(state_freq$n, decreasing = FALSE)])
# set plot theme for assignment
my_plot_theme <- list(
theme_classic() +
theme(plot.background = element_rect(fill = "#EFE7DB"),
panel.background = element_rect(fill = "#EFE7DB"),
panel.grid.major.x = element_line(color = "white"),
axis.title.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold")))
# plot generation
ggplot(data = state_freq, aes(x = n, y = State)) +
geom_col(fill=mpeach) +
labs(title = "California, Texas, and New York have the Most Companies",
subtitle = "with California having 181% (314) more companies than second-place Texas",
x="# of Companies in the Ranking",
y="State") +
scale_x_continuous(limits = c(0, 800),
expand = c(.01, 0.5),
breaks = seq(0, 800, 100)) +
geom_text(
aes(x = n, label = n),
size = 3,
color = mgray, hjust = 0) +
my_plot_theme
# filter for just NY data
# filter for complete cases (they all were w/o NAs)
# plot to show median across industries in NY
inc %>%
filter(State == "NY", complete.cases(.)) %>%
ggplot(aes(x = reorder(Industry, Employees, median), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
ylim(NA, 1000) +
my_plot_theme
# show counts sorted high to low of companies within each industry in NY
inc_ny %>%
count(Industry, sort = TRUE)
# show counts sorted high to low of companies within each industry in NY
inc %>%
filter("State" == "NY")
# show counts sorted high to low of companies within each industry in NY
inc %>%
filter("State" == "NY") %>%
count(Industry, sort = TRUE)
# show counts sorted high to low of companies within each industry in NY
inc %>%
filter(State == "NY") %>%
count(Industry, sort = TRUE)
inc %>%
filter(State =="NY") %>%
group_by(Industry) %>%
summarize(rev_emp = Revenue / Employee)
inc %>%
filter(State =="NY") %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot)
inc %>%
filter(State =="NY") %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot) %>%
ggplot(aes(x = reorder(Industry, rev_per_emp), y = rev_per_emp)) +
geom_bar()
inc %>%
filter(State =="NY") %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot) %>%
ggplot(aes(x = reorder(Industry, rev_per_emp), y = rev_per_emp)) +
geom_bar(stat = "identity")
inc %>%
filter(State =="NY") %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot) %>%
ggplot(aes(x = reorder(Industry, rev_per_emp), y = rev_per_emp)) +
geom_bar(stat = "identity", fill = mpeach) +
my_plot_theme
inc %>%
filter(State =="NY") %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot) %>%
ggplot(aes(x = reorder(Industry, rev_per_emp), y = rev_per_emp)) +
geom_bar(stat = "identity", fill = mpeach) +
coord_flip() +
my_plot_theme
inc %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot) %>%
ggplot(aes(x = reorder(Industry, rev_per_emp), y = rev_per_emp)) +
geom_bar(stat = "identity", fill = mpeach) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
my_plot_theme
View(inc)
inc %>%
filter(complete.cases(.)) %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot) %>%
ggplot(aes(x = reorder(Industry, rev_per_emp), y = rev_per_emp)) +
geom_bar(stat = "identity", fill = mpeach) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="# of Employees",
y="Industry") +
my_plot_theme
inc %>%
filter(complete.cases(.)) %>%
group_by(Industry) %>%
summarize(rev_tot = sum(Revenue), emp_tot = sum(Employees)) %>%
mutate(rev_per_emp = rev_tot/emp_tot) %>%
ggplot(aes(x = reorder(Industry, rev_per_emp), y = rev_per_emp)) +
geom_bar(stat = "identity", fill = mpeach) +
coord_flip() +
labs(title = "Revenue per Employee by Industry",
subtitle = "total revenue of industry / total count employees of industry",
x = "Industry",
y = "Revenue per Employee") +
my_plot_theme
inc %>%
filter(State == "NY", complete.cases(.)) %>%
ggplot(aes(x = reorder(Industry, Employees, median), y = Employees)) +
geom_boxplot(fill = mpeach, outlier.color = mteal) +
coord_flip() +
labs(title = "NY Companies by # of Employees by Industry",
subtitle = "graph does not show two outlyers (Coty & Sutherland)",
x="Industry",
y="# of Employees per Company in NY") +
ylim(NA, 1000) +
my_plot_theme
